# Проект агрегатора недвижимости "Площадь".

# Установка
После форка и клонирования репозитория нужно установить рабочее окружение.
Установку можно разбить на два этапа: установка окружения для бекенда, установка окружения для фронтенда. 
Для разработки предлагаю использовать pycharm.

Далее я описываю ряд шагов, которые нужно выполнить, но я не привожу конкретных команд для их выполнения, их можно посмотреть в интернете, если какие то шаги из непонятны, можно обратиться ко мне.

## Бекенд
Необходимо создать виртуальное окружение в корневой папке с python версии 3.9 (это можно сделать в пайчарме).
Затем с помощью pip нужно установить django, для взаимодействия с PostgeSQL нужно установить psycopg2 через pip, а так же саму СУБД.

Также нужно сконфигурировать Django проект для запуска его одной кнопкой в пайчарме, для этого нужно посмотреть как создаются конфигурации в пайчарме.
Вместо этого можно запускать джанго сервер из командной строки, но лучше все таки создать конфигурацию.

Также советую ОЧЕНЬ ВНИМАТЕЛЬНО разобраться с настройками сервера в *square/settings.py*, там в числе прочих важных настроек задается подключение к БД, причем часть данных, которые относятся только к сайту
хранятся в sqlite, а часть данных (данные от парсера) хранятся в postgres.

Чтобы создать базу данных sqlite (с данными сайта, такими как, например, авторизация) нужно создать и применить миграции, после чего для доступа к панели администратора нужно создать суперпользователя.
Как именно это делается, можно посмотреть в любых туториалах по Django :)

Чтобы создать БД с данными парсера, нужно обратиться к Кириллу, он предоставит схему БД в виде sql файла, затем нужно создать базу в postgres, выполнить в ней sql скрипт (создастся набор таблиц), проверить, что
список полей в моделях ORM (все модели для работы с БД парсера находятся в файле *area_parser/models.py*) соответствует списку полей в базе парсера в postgres (или заново сгенерировать модели, но все равно нужно проверить, что поля в сгенерированных моделях совпадают с полями в БД).
Ну и наконец нужно задать настройки подключения к базе в вышеупомянутом *square/settings.py*. Для наполнения БД данными, нужно запустить программу Кирилла, он подскажет как именно это делать.

В проекте по сути, как было сказано ранее, используются две базы данных, одна с данными сайта - хранится в sqlite, вторая с данными от парсера - хранится в 
postgres. При работе с моделями, решение, в какую базу писать данные, принимает роутер в файле *area_parser/router.py*.
Также стоит отметить, что для моделей парсера не будут применяться миграции, поэтому придется вручную изменять данные моделей при изменении схемы БД парсера.

Таким образом, список шагов которые нужно сделать для установки бекенда:
1) Сделать форк проекта и склонировать его на локальный компьютер
2) Установить PostgreSQL
3) Создать виртуальное окружение с python 3.9 в корне проекта
4) Установить Django и psycopg2
5) Сконфигурировать Django проект для запуска из pycharm
6) Создать миграции и применить их
7) Создать суперпользователя (для доступа к панели администратора)
8) Создать БД парсера в postgres, выполнить sql скрипт для создания таблиц, наполнить ее данными как скажет Кирилл
9) Проверить совпадение полей в ORM-моделях парсера с полями таблиц в БД парсера (или сгенерировать модели заново)

## Фронтенд
После установки бекенда:
1) Установить npm
2) В папке *app_data/frontend* выполнить ```npm install```

Так же можно сконфигурировать запуск сборки фронтенда из pycharm.

## Запуск проекта
1) В папке *app_data/frontend* запустить сборку фронтенда командой ```npm run start``` (для разработки с автопересборкой при изменениях в файлах .js и .scss) или ```npm run build``` (для продакшена). Либо, если сконфигурирован запуск из pycharm, нужно просто нажать кнопку запуска конфигурации.
2) Запустить сервер Django
3) Открыть сайт по адресу, который появится в терминале.
